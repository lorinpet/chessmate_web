(()=>{var e={685:(e,t,a)=>{var s={"./(tabs)/404.tsx":3296,"./(tabs)/archive.tsx":2782,"./(tabs)/dashboard.tsx":9140,"./(tabs)/forgot.tsx":9099,"./(tabs)/game.tsx":2608,"./(tabs)/login.tsx":1739,"./(tabs)/profile.tsx":8415,"./(tabs)/register.tsx":5445,"./(tabs)/reset.tsx":7353,"./(tabs)/settings.tsx":7901,"./+not-found.tsx":8973,"./_layout.tsx":5111,"./index.tsx":5250};function l(e){var t=o(e);return a(t)}function o(e){if(!a.o(s,e)){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}return s[e]}l.keys=function(){return Object.keys(s)},l.resolve=o,e.exports=l,l.id=685},1739:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(2772),l=a(558),o=a(3668),n=a(6283),r=a(3929),i=a(6773),d=a(5648),c=a(484),u=a(1087),f=a(9637),h=a(6665),g=a(397);const m=o.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",overflow:"hidden",backgroundColor:"#444"},title:{fontSize:32,fontWeight:"bold",marginBottom:10,color:"#fff"},profileImage:{width:200,height:200,borderRadius:50,marginBottom:10},input:{width:"80%",height:50,backgroundColor:"#444",color:"#ccc",borderColor:"#ccc",borderWidth:2,borderRadius:2,paddingHorizontal:15,marginBottom:5,fontSize:16},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},button:{width:"80%",height:50,backgroundColor:"#fff",justifyContent:"center",alignItems:"center",borderRadius:5,marginBottom:5},buttonText:{color:"#00f",fontSize:18,fontWeight:"bold"},linkText:{color:"#00f",fontSize:14,fontWeight:"bold",marginVertical:10}}),p=()=>{const[e,t]=(0,h.useState)(!0),[a,o]=(0,h.useState)(""),[p,b]=(0,h.useState)(""),[x,y]=(0,h.useState)({username:!1,password:!1}),[w,j]=(0,h.useState)("0"),[S,k]=(0,h.useState)(!1),C=(0,f.useRouter)(),v="chessmate-production.up.railway.app";(0,h.useEffect)((()=>{e&&(async()=>{let e;try{const a=await u.default.getItem("token");e=await fetch("https://"+v+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"0"===e.code&&C.push("dashboard")}))})()}),[]);return(0,g.jsx)(s.default,{children:(0,g.jsxs)(r.default,{style:[m.container,{minHeight:(0,l.default)().height}],children:[(0,g.jsx)(n.default,{style:m.title,children:"ChessMate"}),(0,g.jsx)(c.default,{source:{uri:"https://"+v+"/uploads/cm.png"},style:m.profileImage}),(0,g.jsx)(i.default,{style:m.input,placeholder:"USERNAME",placeholderTextColor:"#bbb",value:a,onChangeText:o}),x.username&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid username."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"PASSWORD",placeholderTextColor:"#bbb",value:p,onChangeText:b,secureTextEntry:!0}),x.password&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid password."}),(0,g.jsx)(d.default,{style:m.button,onPress:async()=>{const e={username:!1,password:!1};let t=!1;/^[A-Za-z][A-Za-z0-9_]{2,14}$/.test(a)||(e.username=!0,j("0"),t=!0);if(/^[A-Za-z0-9_]{8,32}$/.test(p)||(e.password=!0,j("0"),t=!0),y(e),!t){k(!0);try{const e=await fetch("https://"+v+"/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,password:p})});if(e.ok){const t=await e.json();await u.default.setItem("token",t.message),C.push("dashboard")}else{const t=await e.json();j(t.error)}}catch(s){j("4")}finally{k(!1)}}},disabled:S,children:(0,g.jsx)(n.default,{style:m.buttonText,children:S?"Logging in...":"LOGIN"})}),"0"!==w&&(0,g.jsx)(n.default,{style:m.warning,children:"1"===w?"Account not confirmed by email yet.":"2"===w?"Wrong password.":"3"===w?"User doesn't exist.":"Unknown error."}),(0,g.jsx)(f.Link,{href:"forgot",style:m.linkText,children:(0,g.jsx)(n.default,{style:m.linkText,children:"Forgot password?"})}),(0,g.jsx)(f.Link,{href:"register",style:m.linkText,children:(0,g.jsx)(n.default,{style:m.linkText,children:"Don't have an account yet? Register."})})]})})}},2608:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>T});var s=a(3929),l=a(6283),o=a(3668),n=a(558),r=a(2772),i=a(5648),d=a(484),c=a(6773),u=a(1087),f=a(9149),h=a(9637),g=a(6665),m=a(2909),p=a(397);const b="chessmate-production.up.railway.app",x={P:"https://"+b+"/uploads/wp.png",N:"https://"+b+"/uploads/wn.png",B:"https://"+b+"/uploads/wb.png",R:"https://"+b+"/uploads/wr.png",Q:"https://"+b+"/uploads/wq.png",K:"https://"+b+"/uploads/wk.png",p:"https://"+b+"/uploads/bp.png",n:"https://"+b+"/uploads/bn.png",b:"https://"+b+"/uploads/bb.png",r:"https://"+b+"/uploads/br.png",q:"https://"+b+"/uploads/bq.png",k:"https://"+b+"/uploads/bk.png"},y=["P","N","B","R","Q","K"],w=["p","n","b","r","q","k"],j=[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]],S=(e,t,a,s,l,o)=>{for(let n=0;n<8;n++)for(let r=0;r<8;r++){const i=a[n][r];if(i&&(s?w.includes(i):y.includes(i))){if(k(n,r,i,a,!0,!1,l,o).some((a=>a.row===e&&a.col===t)))return!0}}return!1},k=(e,t,a,s,l,o,n,r)=>{const i=[],d=a===a.toUpperCase(),c=(e,t)=>e>-1&&e<8&&t>-1&&t<8,u=(e,t)=>{const a=s[e][t];return!a||(d?a===a.toLowerCase():a===a.toUpperCase())},f=(e,t)=>{c(e,t)&&i.push({row:e,col:t})};switch(a.toUpperCase()){case"P":const a=d?-1:1,i=d?6:1;if(l||!c(e+a,t)||s[e+a][t]||(f(e+a,t),e!==i||s[e+2*a][t]||f(e+2*a,t)),c(e+a,t-1)&&s[e+a][t-1]&&u(e+a,t-1)&&f(e+a,t-1),c(e+a,t+1)&&s[e+a][t+1]&&u(e+a,t+1)&&f(e+a,t+1),!l&&n.start&&n.target){const{from:l,to:o}={from:n.start,to:n.target};"p"!==s[o.row][o.col].toLowerCase()||2!==Math.abs(l.row-o.row)||o.row!==e||o.col!==t-1&&o.col!==t+1||f(e+a,o.col)}break;case"N":[{row:e-2,col:t-1},{row:e-2,col:t+1},{row:e-1,col:t-2},{row:e-1,col:t+2},{row:e+1,col:t-2},{row:e+1,col:t+2},{row:e+2,col:t-1},{row:e+2,col:t+1}].forEach((e=>{c(e.row,e.col)&&u(e.row,e.col)&&f(e.row,e.col)}));break;case"B":for(let l=1;l<8&&c(e+l,t+l);l++){if(s[e+l][t+l]){u(e+l,t+l)&&f(e+l,t+l);break}f(e+l,t+l)}for(let l=1;l<8&&c(e+l,t-l);l++){if(s[e+l][t-l]){u(e+l,t-l)&&f(e+l,t-l);break}f(e+l,t-l)}for(let l=1;l<8&&c(e-l,t+l);l++){if(s[e-l][t+l]){u(e-l,t+l)&&f(e-l,t+l);break}f(e-l,t+l)}for(let l=1;l<8&&c(e-l,t-l);l++){if(s[e-l][t-l]){u(e-l,t-l)&&f(e-l,t-l);break}f(e-l,t-l)}break;case"R":for(let l=1;l<8&&c(e+l,t);l++){if(s[e+l][t]){u(e+l,t)&&f(e+l,t);break}f(e+l,t)}for(let l=1;l<8&&c(e-l,t);l++){if(s[e-l][t]){u(e-l,t)&&f(e-l,t);break}f(e-l,t)}for(let l=1;l<8&&c(e,t+l);l++){if(s[e][t+l]){u(e,t+l)&&f(e,t+l);break}f(e,t+l)}for(let l=1;l<8&&c(e,t-l);l++){if(s[e][t-l]){u(e,t-l)&&f(e,t-l);break}f(e,t-l)}break;case"Q":k(e,t,d?"R":"r",s,!1,o,n,r).forEach((e=>f(e.row,e.col))),k(e,t,d?"B":"b",s,!1,o,n,r).forEach((e=>f(e.row,e.col)));break;case"K":[{row:e-1,col:t-1},{row:e-1,col:t},{row:e-1,col:t+1},{row:e,col:t-1},{row:e,col:t+1},{row:e+1,col:t-1},{row:e+1,col:t},{row:e+1,col:t+1}].forEach((e=>{c(e.row,e.col)&&u(e.row,e.col)&&f(e.row,e.col)})),l||((!d||r.whiteKingside)&&(d||r.blackKingside)||s[e][t+1]||s[e][t+2]||S(e,t,s,d,n,r)||S(e,t+1,s,d,n,r)||S(e,t+2,s,d,n,r)||f(e,t+2),(!d||r.whiteQueenside)&&(d||r.blackQueenside)||s[e][t-1]||s[e][t-2]||s[e][t-3]||S(e,t,s,d,n,r)||S(e,t-1,s,d,n,r)||S(e,t-2,s,d,n,r)||f(e,t-2))}if(o){const a=i.filter((a=>{const l=((e,t,a)=>{const s=e.map((e=>[...e])),l=s[t.row][t.col];return s[t.row][t.col]="",s[a.row][a.col]=l,s})(s,{row:e,col:t},a);return!((e,t,a,s)=>{const l=t?"K":"k";let o=-1,n=-1;for(let r=0;r<8;r++){for(let t=0;t<8;t++)if(e[r][t]===l){o=r,n=t;break}if(-1!==o)break}for(let r=0;r<8;r++)for(let l=0;l<8;l++){const i=e[r][l];if(i&&(t?w.includes(i):y.includes(i))&&k(r,l,i,e,!0,!1,a,s).some((e=>e.row===o&&e.col===n)))return!0}return!1})(l,d,n,r)}));return a}return i},C=g.memo((({boardSize:e,boardState:t,onSquarePress:a,selectedPiece:l,fliped:o,epFlags:n,castleFlags:r})=>{const c=e/8,u=(e,t)=>o?{row:7-e,col:7-t}:{row:e,col:t};return(0,p.jsxs)(s.default,{style:{width:e,height:e},children:[(0,p.jsx)(m.default,{width:e,height:e,children:(()=>{const e=[],a=(0,g.useMemo)((()=>l?k(l.row,l.col,l.piece,t,!1,!0,n,r):[]),[l,t,n,r]);for(let t=0;t<8;t++)for(let s=0;s<8;s++){const{row:o,col:r}=u(t,s),i=r*c,d=o*c,f=(t+s)%2===0?"#c3c2c2":"#504d55",h=(t+s)%2===0?"#fc8":"#fc4",g=(t+s)%2===0?"#c00":"#800",b=a.some((e=>e.row===t&&e.col===s));e.push((0,p.jsx)(m.Rect,{x:i,y:d,width:c,height:c,fill:b?g:n.start&&n.start.row===t&&n.start.col===s||n.target&&n.target.row===t&&n.target.col===s||l&&l.row===t&&l.col===s?h:f},`square-${t}-${s}`))}return e})()}),(()=>{const e=[];for(let a=0;a<8;a++)for(let s=0;s<8;s++){const l=t[a][s];if(l){const{row:t,col:o}=u(a,s),n=o*c,r=t*c;e.push((0,p.jsx)(d.default,{source:{uri:x[l]},style:{position:"absolute",left:n,top:r,width:c,height:c}},`piece-${a}-${s}`))}}return e})(),(()=>{const e=[];for(let t=0;t<8;t++)for(let s=0;s<8;s++){const{row:l,col:o}=u(t,s),n=o*c,r=l*c;e.push((0,p.jsx)(i.default,{style:{position:"absolute",left:n,top:r,width:c,height:c},onPress:()=>a(t,s)},`touchable-${t}-${s}`))}return e})()]})})),v=({isWhite:e,onSelect:t,boardSize:a})=>{const l=e?["Q","R","B","N"]:["q","r","b","n"],o=a/8;return(0,p.jsx)(s.default,{style:[z.promotionMenu,{width:a,height:1.5*o,transform:[{translateX:-a/2},{translateY:.75*-o}]}],children:l.map((e=>(0,p.jsx)(i.default,{style:z.promotionOption,onPress:()=>t(e),children:(0,p.jsx)(d.default,{source:{uri:x[e]},style:{width:o,height:o}})},e)))})},z=o.default.create({container:{justifyContent:"center",alignItems:"center",backgroundColor:"#444"},topBar:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:20,marginTop:20},backArrow:{flex:1,alignItems:"flex-start"},flipBoard:{flex:1,alignItems:"flex-end"},topCenter:{flex:2,alignItems:"center"},topRight:{flex:1,alignItems:"flex-end"},profilePicture:{borderRadius:25},timer:{fontWeight:"bold",color:"#888"},moveIndicator:{fontWeight:"bold",color:"#ccc"},userInfo:{fontWeight:"bold",color:"#888"},rating:{color:"#ccc"},boardWithLabelsContainer:{flexDirection:"row",alignItems:"center"},rankLabelsContainer:{justifyContent:"space-between",marginHorizontal:5},rankLabel:{color:"#ccc"},fileLabelsContainer:{flexDirection:"row",marginVertical:5},fileLabel:{color:"#ccc",textAlign:"center",flex:1},bottomBar:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:20,marginBottom:10},bottomLeft:{flex:1,alignItems:"flex-start"},bottomCenter:{flex:2,alignItems:"center"},buttonContainer:{flexDirection:"row",justifyContent:"space-around",width:"100%",marginTop:20},button:{alignItems:"center",backgroundColor:"#888",paddingVertical:10,borderRadius:25},buttonText:{color:"#fff",fontWeight:"bold",marginTop:5},capturedPiecesContainer:{flexDirection:"row"},capturedWhite:{flexDirection:"row-reverse"},capturedBlack:{flexDirection:"row"},promotionMenu:{flexDirection:"row",justifyContent:"space-around",alignItems:"center",backgroundColor:"#888",borderRadius:10,position:"absolute",top:"50%",left:"50%"},promotionOption:{backgroundColor:"#444",borderRadius:10},chatContainer:{position:"absolute",bottom:80,right:20,width:300,height:200,backgroundColor:"#888",borderRadius:10,padding:10},chatMessage:{color:"#fff",fontSize:14,marginBottom:5},chatInputContainer:{flexDirection:"row"},chatInput:{flex:1,backgroundColor:"#444",color:"#fff",borderRadius:5,padding:5,marginRight:10},sendButton:{backgroundColor:"#888",borderRadius:5,padding:5},gameOverText:{fontSize:24,fontWeight:"bold",color:"#fff",textAlign:"center"}}),T=()=>{const e=(0,h.useLocalSearchParams)(),t=e.gameId,a=e.color,o=e.name,m=e.image,S=e.rating,[k,T]=(0,g.useState)(!0),[P,I]=(0,g.useState)("????"),[R,B]=(0,g.useState)("https://"+b+"/uploads/_.png"),[W,L]=(0,g.useState)("????"),[N,_]=(0,g.useState)("????"),[O,D]=(0,g.useState)("https://"+b+"/uploads/_.png"),[A,E]=(0,g.useState)("????"),{width:$,height:G}=(0,n.default)(),H=$>G?.9*G:.9*$,M=["A","B","C","D","E","F","G","H"],V=["1","2","3","4","5","6","7","8"].reverse(),[q,K]=(0,g.useState)(j),[Q,F]=(0,g.useState)(null),[U,J]=(0,g.useState)(null),[Y,Z]=(0,g.useState)([]),[X,ee]=(0,g.useState)([]),[te,ae]=(0,g.useState)(!0),[se,le]=(0,g.useState)({start:null,target:null}),[oe,ne]=(0,g.useState)({whiteKingside:!1,blackKingside:!1,whiteQueenside:!1,blackQueenside:!1}),[re,ie]=(0,g.useState)(null),[de,ce]=(0,g.useState)(!1),[ue,fe]=(0,g.useState)(null),[he,ge]=(0,g.useState)(0),[me,pe]=(0,g.useState)(0),[be,xe]=(0,g.useState)("ongoing"),[ye,we]=(0,g.useState)([]),[je,Se]=(0,g.useState)(""),[ke,Ce]=(0,g.useState)(!1),ve=(0,h.useRouter)();(0,g.useEffect)((()=>{k&&(async()=>{let e;try{const t=await u.default.getItem("token");e=await fetch("https://"+b+"/verify?token="+t),T(!1)}catch(t){return void T(!1)}e.json().then((e=>{"1"===e.code&&ve.push("login")}))})()}),[]);const ze=async(e,t)=>{const a=await fetch(e);t?B(a.url):D(a.url)};(0,g.useEffect)((()=>{const e=new WebSocket("wss://"+b+"/game?gameId="+t+"&color="+a+"&name="+o+"&image="+m+"&rating="+S);return e.onopen=()=>{console.log("WebSocket connected")},e.onmessage=e=>{const t=JSON.parse(e.data);"assignColor"===t.type?(ie(t.color),ce("black"===t.color)):"setWhiteUser"===t.type?(I(t.whiteName),ze(t.whiteImage,!0),L(t.whiteRating)):"setBlackUser"===t.type?(_(t.blackName),ze(t.blackImage,!1),E(t.blackRating)):"gameState"===t.type?(K(t.gameState.board),ae("white"===t.gameState.currentTurn),Z(t.gameState.capturedWhite),ee(t.gameState.capturedBlack),le({start:t.gameState.lastMoveStart,target:t.gameState.lastMoveTarget}),ne({whiteKingside:t.gameState.whiteKingside,blackKingside:t.gameState.blackKingside,whiteQueenside:t.gameState.whiteQueenside,blackQueenside:t.gameState.blackQueenside}),ge(t.gameState.whiteTimer),pe(t.gameState.blackTimer),t.gameState.winner&&(J(null),F(null),xe(t.gameState.winner))):"chat"===t.type&&we((e=>[...e,t.message]))},e.onclose=()=>{console.log("WebSocket disconnected")},e.onerror=e=>{console.error("WebSocket error:",e)},fe(e),()=>{e.close()}}),[]);const Te=(e,t,a)=>{ue&&ue.send(JSON.stringify({type:"move",from:e,to:t,promotion:a}))},Pe=e=>{const t=H/8,a=H/16;return(0,p.jsx)(s.default,{style:[z.capturedPiecesContainer,{height:t}],children:e.map(((e,s)=>(0,p.jsx)(d.default,{source:{uri:x[e]},style:[{width:a,height:t}]},`captured-${e}-${s}`)))})},Ie=e=>{const t=Math.min(G/800,$/400,2);return Math.max(e*t,2)},Re=.25*$,Be=e=>{const t=e%60;return`${Math.floor(e/60)}:${t<10?"0":""}${t}`};return(0,p.jsx)(r.default,{children:(0,p.jsxs)(s.default,{style:[z.container,{minHeight:G}],children:[(0,p.jsxs)(s.default,{style:z.topBar,children:[(0,p.jsx)(s.default,{style:z.backArrow,children:(0,p.jsx)(h.Link,{href:"dashboard",children:(0,p.jsx)(s.default,{children:(0,p.jsx)(f.default,{name:"arrow-back",size:Ie(30),color:"#ccc"})})})}),(0,p.jsxs)(s.default,{style:z.topCenter,children:[(0,p.jsx)(l.default,{style:[z.timer,{fontSize:Ie(32)}],children:Be(de?he:me)}),(0,p.jsx)(l.default,{style:[z.moveIndicator,{fontSize:Ie(20)}],children:"ongoing"!==be?" ":te?de?"White to move":" ":de?" ":"Black to move"})]}),(0,p.jsxs)(s.default,{style:z.topRight,children:[(0,p.jsx)(d.default,{source:{uri:de?R:O},style:[z.profilePicture,{width:Ie(50),height:Ie(50)}]}),(0,p.jsx)(l.default,{style:[z.userInfo,{fontSize:Ie(18)}],children:de?P:N}),(0,p.jsx)(l.default,{style:[z.rating,{fontSize:Ie(14)}],children:de?W:A})]})]}),Pe(X),(0,p.jsx)(s.default,{style:[z.fileLabelsContainer,{width:H}],children:M.map(((e,t)=>(0,p.jsx)(l.default,{style:[z.fileLabel,{fontSize:12}],children:de?M[M.length-1-t]:e},`file-top-${e}`)))}),(0,p.jsxs)(s.default,{style:z.boardWithLabelsContainer,children:[(0,p.jsx)(s.default,{style:z.rankLabelsContainer,children:V.map(((e,t)=>(0,p.jsx)(l.default,{style:[z.rankLabel,{marginVertical:H/26,fontSize:12}],children:de?V[V.length-1-t]:e},`rank-${e}`)))}),(0,p.jsxs)(s.default,{children:[(0,p.jsx)(C,{boardSize:H,boardState:q,onSquarePress:(e,t)=>{if("????"===P||"????"===N)return;if("ongoing"!==be||U||ke)return J(null),void F(null);const a=q[e][t];if(Q){const s={row:Q.row,col:Q.col},l={row:e,col:t};if(Q.row===e&&Q.col===t)F(null);else if(a&&("white"===re&&te&&y.includes(a)||"black"===re&&!te&&w.includes(a)))F({row:e,col:t,piece:a});else{const a=te?0:7;if("p"===Q.piece.toLowerCase()&&e===a)return void J({row:e,col:t});Te(s,l,null),F(null)}}else a&&("white"===re&&te&&y.includes(a)||"black"===re&&!te&&w.includes(a))&&F({row:e,col:t,piece:a})},selectedPiece:Q,fliped:de,epFlags:se,castleFlags:oe}),U&&(0,p.jsx)(v,{isWhite:"white"===re,onSelect:e=>{if(U&&Q){const t={row:Q.row,col:Q.col},a={row:U.row,col:U.col};Te(t,a,e),J(null),F(null)}},boardSize:H})]}),(0,p.jsx)(s.default,{style:z.rankLabelsContainer,children:V.map(((e,t)=>(0,p.jsx)(l.default,{style:[z.rankLabel,{marginVertical:H/26,fontSize:12}],children:de?V[V.length-1-t]:e},`rank-right-${e}`)))})]}),(0,p.jsx)(s.default,{style:[z.fileLabelsContainer,{width:H}],children:M.map(((e,t)=>(0,p.jsx)(l.default,{style:[z.fileLabel,{fontSize:12}],children:de?M[M.length-1-t]:e},`file-bottom-${e}`)))}),Pe(Y),(0,p.jsxs)(s.default,{style:z.bottomBar,children:[(0,p.jsxs)(s.default,{style:z.bottomLeft,children:[(0,p.jsx)(d.default,{source:{uri:de?O:R},style:[z.profilePicture,{width:Ie(50),height:Ie(50)}]}),(0,p.jsx)(l.default,{style:[z.userInfo,{fontSize:Ie(18)}],children:de?N:P}),(0,p.jsx)(l.default,{style:[z.rating,{fontSize:Ie(14)}],children:de?A:W})]}),(0,p.jsxs)(s.default,{style:z.bottomCenter,children:[(0,p.jsx)(l.default,{style:[z.timer,{fontSize:Ie(32)}],children:Be(de?me:he)}),(0,p.jsx)(l.default,{style:[z.moveIndicator,{fontSize:Ie(20)}],children:"ongoing"!==be?" ":te?de?" ":"White to move":de?"Black to move":" "})]}),(0,p.jsx)(s.default,{style:z.flipBoard,children:(0,p.jsx)(i.default,{children:(0,p.jsx)(f.default,{name:"flip",size:Ie(30),color:"#ccc",onPress:()=>{ce(!de)}})})})]}),(0,p.jsx)(s.default,{children:(0,p.jsx)(l.default,{style:z.gameOverText,children:"ongoing"===be?"white"===re?"You are playing the white pieces":"You are playing the black pieces":"white"===be?"White won":"black"===be?"Black won":"Draw"})}),(0,p.jsxs)(s.default,{style:z.buttonContainer,children:[(0,p.jsxs)(i.default,{onPress:()=>{"ongoing"===be&&ue&&ue.send(JSON.stringify({type:"offerDraw"}))},style:[z.button,{width:Re}],children:[(0,p.jsx)(f.default,{name:"handshake",size:Ie(30),color:"#fff"}),(0,p.jsx)(l.default,{style:[z.buttonText,{fontSize:Ie(14)}],children:"Offer Draw"})]}),(0,p.jsxs)(i.default,{onPress:()=>{"ongoing"===be&&ue&&ue.send(JSON.stringify({type:"resign"}))},style:[z.button,{width:Re}],children:[(0,p.jsx)(f.default,{name:"flag",size:Ie(30),color:"#fff"}),(0,p.jsx)(l.default,{style:[z.buttonText,{fontSize:Ie(14)}],children:"Resign"})]}),(0,p.jsxs)(i.default,{onPress:()=>{"????"!==P&&"????"!==N&&"Stockfish"!==P&&"Stockfish"!==N&&(J(null),F(null),Ce(!ke))},style:[z.button,{width:Re}],children:[(0,p.jsx)(f.default,{name:"chat",size:Ie(30),color:"#fff"}),(0,p.jsx)(l.default,{style:[z.buttonText,{fontSize:Ie(14)}],children:"Chat"})]}),ke&&(0,p.jsxs)(s.default,{style:z.chatContainer,children:[(0,p.jsx)(r.default,{children:ye.map(((e,t)=>(0,p.jsx)(l.default,{style:z.chatMessage,children:e},t)))}),(0,p.jsxs)(s.default,{style:z.chatInputContainer,children:[(0,p.jsx)(c.default,{style:z.chatInput,value:je,onChangeText:Se,placeholder:"Type a message..."}),(0,p.jsx)(i.default,{style:z.sendButton,onPress:()=>{je.trim()&&ue&&(ue.send(JSON.stringify({type:"chat",message:je})),Se(""))},children:(0,p.jsx)(f.default,{name:"send",size:Ie(20),color:"#fff"})})]})]})]})]})})}},2782:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>k});var s=a(3929),l=a(6283),o=a(3668),n=a(558),r=a(2772),i=a(5648),d=a(484),c=a(1087),u=a(9149),f=a(9637),h=a(6665),g=a(2909),m=a(397);const p=["P","N","B","R","Q","K"],b=["p","n","b","r","q","k"],x="chessmate-production.up.railway.app",y={P:"https://"+x+"/uploads/wp.png",N:"https://"+x+"/uploads/wn.png",B:"https://"+x+"/uploads/wb.png",R:"https://"+x+"/uploads/wr.png",Q:"https://"+x+"/uploads/wq.png",K:"https://"+x+"/uploads/wk.png",p:"https://"+x+"/uploads/bp.png",n:"https://"+x+"/uploads/bn.png",b:"https://"+x+"/uploads/bb.png",r:"https://"+x+"/uploads/br.png",q:"https://"+x+"/uploads/bq.png",k:"https://"+x+"/uploads/bk.png"};let w=[["r","n","b","q","k","b","n","r"],["p","p","p","p","p","p","p","p"],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["P","P","P","P","P","P","P","P"],["R","N","B","Q","K","B","N","R"]];const j=({boardSize:e,boardState:t,fliped:a})=>{const l=e/8,o=(e,t)=>a?{row:7-e,col:7-t}:{row:e,col:t};return(0,m.jsxs)(s.default,{style:{width:e,height:e},children:[(0,m.jsx)(g.default,{width:e,height:e,children:(()=>{const e=[];for(let t=0;t<8;t++)for(let a=0;a<8;a++){const{row:s,col:n}=o(t,a),r=n*l,i=s*l,d=(t+a)%2===0?"#c3c2c2":"#504d55";e.push((0,m.jsx)(g.Rect,{x:r,y:i,width:l,height:l,fill:d},`square-${t}-${a}`))}return e})()}),(()=>{const e=[];for(let a=0;a<8;a++)for(let s=0;s<8;s++){const n=t[a][s];if(n){const{row:t,col:r}=o(a,s),i=r*l,c=t*l;e.push((0,m.jsx)(d.default,{source:{uri:y[n]},style:{position:"absolute",left:i,top:c,width:l,height:l}},`piece-${a}-${s}`))}}return e})()]})},S=o.default.create({container:{justifyContent:"center",alignItems:"center",backgroundColor:"#444"},topBar:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:20,marginTop:20},backArrow:{flex:1,alignItems:"flex-start"},flipBoard:{flex:1,alignItems:"flex-end"},topCenter:{flex:2,alignItems:"center"},topRight:{flex:1,alignItems:"flex-end"},profilePicture:{borderRadius:25},analysisIndicator:{fontWeight:"bold",textAlign:"center",color:"#ccc",marginVertical:5},moveIndicator:{fontWeight:"bold",textAlign:"center",color:"#ccc",marginTop:10},userInfo:{fontWeight:"bold",color:"#888"},rating:{color:"#ccc"},boardWithLabelsContainer:{flexDirection:"row",alignItems:"center"},rankLabelsContainer:{justifyContent:"space-between",marginHorizontal:5},rankLabel:{color:"#ccc"},fileLabelsContainer:{flexDirection:"row",marginVertical:5},fileLabel:{color:"#ccc",textAlign:"center",flex:1},bottomBar:{flexDirection:"row",alignItems:"center",width:"100%",paddingHorizontal:20,marginBottom:10},bottomLeft:{flex:1,alignItems:"flex-start"},bottomCenter:{flex:2,alignItems:"center"},buttonContainer:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginTop:20},button:{alignItems:"center",borderWidth:2,borderColor:"#ccc",backgroundColor:"#888",paddingVertical:10,borderRadius:5},analyseButton:{alignItems:"center",backgroundColor:"#000",padding:15,borderRadius:5}}),k=()=>{const e=(0,f.useLocalSearchParams)().archive,[t,a]=(0,h.useState)(!0),[o,g]=(0,h.useState)(null),[y,k]=(0,h.useState)({bestmove:"Press button to analyse",evaluation:""}),[C,v]=(0,h.useState)(!1),[z,T]=(0,h.useState)(-1),[P,I]=(0,h.useState)("????"),[R,B]=(0,h.useState)("https://"+x+"/uploads/_.png"),[W,L]=(0,h.useState)("????"),[N,_]=(0,h.useState)("????"),[O,D]=(0,h.useState)("https://"+x+"/uploads/_.png"),[A,E]=(0,h.useState)("????"),{width:$,height:G}=(0,n.default)(),H=$>G?.9*G:.9*$,M=["A","B","C","D","E","F","G","H"],V=["1","2","3","4","5","6","7","8"].reverse(),[q,K]=(0,h.useState)("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"),[Q,F]=(0,h.useState)(w),[U,J]=(0,h.useState)(!1),Y=(0,f.useRouter)();(0,h.useEffect)((()=>{t&&(async()=>{let e;try{const t=await c.default.getItem("token");e=await fetch("https://"+x+"/verify?token="+t),a(!1)}catch(t){return void a(!1)}e.json().then((e=>{"1"===e.code&&Y.push("login")}))})()}),[]);const Z=e=>{K(e);const t=e.split(" ")[0],a=[["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""],["","","","","","","",""]];let s=0;for(let l=0;l<8;l++)for(let e=0;e<8;e++)["1","2","3","4","5","6","7","8"].includes(t[s])?(e+=t[s],e--):(p.includes(t[s])||b.includes(t[s]))&&(a[l][e]=t[s]),s++,"/"===t[s]&&s++;w=a,F(a)};(0,h.useEffect)((()=>{"????"===P&&"????"===N&&((async()=>{const t=await fetch("https://"+x+"/game?gameId="+e),a=await t.json(),s=await a.message.white_player,l=await fetch("https://"+x+"/player?playerId="+s),o=await l.json(),n=await a.message.black_player,r=await fetch("https://"+x+"/player?playerId="+n),i=await r.json(),d=await o.message.username;I(d);const c=await i.message.username;_(c);const u=await o.message.profile_picture_url,f=await fetch("https://"+x+"/"+u);B(f.url);const h=await i.message.profile_picture_url,g=await fetch("https://"+x+"/"+h);D(g.url);const m=await a.message.time_control;if(["60+0","120+1","180+0"].includes(m)){const e=await o.message.bullet_rating;L(e);const t=await i.message.bullet_rating;E(t)}else if(["180+2","300+0","300+3"].includes(m)){const e=await o.message.blitz_rating;L(e);const t=await i.message.blitz_rating;E(t)}else if(["600+0","600+5","900+0"].includes(m)){const e=await o.message.rapid_rating;L(e);const t=await i.message.rapid_rating;E(t)}else if(["900+10","1800+0","1800+20"].includes(m)){const e=await o.message.classical_rating;L(e);const t=await i.message.classical_rating;E(t)}const p=await a.message.starting_position;Z(p)})(),(async()=>{(await fetch("https://"+x+"/fetch?archive="+e)).json().then((e=>g(e.game)))})())}),[]);const X=e=>{const t=Math.min(G/800,$/400,2);return Math.max(e*t,2)},ee=.25*$;return(0,m.jsx)(r.default,{children:(0,m.jsxs)(s.default,{style:[S.container,{minHeight:G}],children:[(0,m.jsxs)(s.default,{style:S.topBar,children:[(0,m.jsx)(s.default,{style:S.backArrow,children:(0,m.jsx)(f.Link,{href:"profile",children:(0,m.jsx)(s.default,{children:(0,m.jsx)(u.default,{name:"arrow-back",size:X(30),color:"#ccc"})})})}),(0,m.jsxs)(s.default,{style:S.topCenter,children:[(0,m.jsx)(l.default,{style:[S.analysisIndicator,{fontSize:X(20)}],children:"bestmove (none)"===y.bestmove.trim()?"No possible move":y.bestmove.trim()}),(0,m.jsx)(l.default,{style:[S.analysisIndicator,{fontSize:X(20)}],children:"bestmove (none)"===y.bestmove.trim()?"":y.evaluation.trim()})]}),(0,m.jsxs)(s.default,{style:S.topRight,children:[(0,m.jsx)(d.default,{source:{uri:U?R:O},style:[S.profilePicture,{width:X(50),height:X(50)}]}),(0,m.jsx)(l.default,{style:[S.userInfo,{fontSize:X(18)}],children:U?P:N}),(0,m.jsx)(l.default,{style:[S.rating,{fontSize:X(14)}],children:U?W:A})]})]}),(0,m.jsx)(s.default,{style:[S.fileLabelsContainer,{width:H}],children:M.map(((e,t)=>(0,m.jsx)(l.default,{style:[S.fileLabel,{fontSize:12}],children:U?M[M.length-1-t]:e},`file-top-${e}`)))}),(0,m.jsxs)(s.default,{style:S.boardWithLabelsContainer,children:[(0,m.jsx)(s.default,{style:S.rankLabelsContainer,children:V.map(((e,t)=>(0,m.jsx)(l.default,{style:[S.rankLabel,{marginVertical:H/26,fontSize:12}],children:U?V[V.length-1-t]:e},`rank-${e}`)))}),(0,m.jsx)(s.default,{children:(0,m.jsx)(j,{boardSize:H,boardState:Q,fliped:U})}),(0,m.jsx)(s.default,{style:S.rankLabelsContainer,children:V.map(((e,t)=>(0,m.jsx)(l.default,{style:[S.rankLabel,{marginVertical:H/26,fontSize:12}],children:U?V[V.length-1-t]:e},`rank-right-${e}`)))})]}),(0,m.jsx)(s.default,{style:[S.fileLabelsContainer,{width:H}],children:M.map(((e,t)=>(0,m.jsx)(l.default,{style:[S.fileLabel,{fontSize:12}],children:U?M[M.length-1-t]:e},`file-bottom-${e}`)))}),(0,m.jsxs)(s.default,{style:S.bottomBar,children:[(0,m.jsxs)(s.default,{style:S.bottomLeft,children:[(0,m.jsx)(d.default,{source:{uri:U?O:R},style:[S.profilePicture,{width:X(50),height:X(50)}]}),(0,m.jsx)(l.default,{style:[S.userInfo,{fontSize:X(18)}],children:U?N:P}),(0,m.jsx)(l.default,{style:[S.rating,{fontSize:X(14)}],children:U?A:W})]}),(0,m.jsxs)(s.default,{style:S.bottomCenter,children:[(0,m.jsx)(i.default,{onPress:async()=>{const e=[];o?.moves.forEach((t=>{e.length<=z&&e.push(t.uci)})),v(!0);(await fetch("https://"+x+"/analyse?fen="+q+"&moves="+e.join(" "))).json().then((e=>k(e))),v(!1)},style:[S.analyseButton,{width:ee}],children:(0,m.jsx)(l.default,{style:[S.analysisIndicator,{fontSize:X(16)}],children:C?"ANALYSING":"ANALYSE"})}),(0,m.jsx)(l.default,{style:[S.moveIndicator,{fontSize:X(16)}],children:-1===z?"Start position":o?.moves[z].uci})]}),(0,m.jsx)(s.default,{style:S.flipBoard,children:(0,m.jsx)(i.default,{children:(0,m.jsx)(u.default,{name:"flip",size:X(30),color:"#ccc",onPress:()=>{J(!U)}})})})]}),(0,m.jsxs)(s.default,{style:S.buttonContainer,children:[(0,m.jsx)(i.default,{onPress:()=>{-1!==z&&k({bestmove:"Press button to analyse",evaluation:""});const e=w;T(-1),F(e)},style:[S.button,{width:ee}],children:(0,m.jsx)(u.default,{name:"keyboard-double-arrow-left",size:X(30),color:"#fff"})}),(0,m.jsx)(i.default,{onPress:()=>{if(-1!==z){k({bestmove:"Press button to analyse",evaluation:""});const e=z-1!==-1?JSON.parse(o?.moves[z-1].fen):w;T(Math.max(z-1,-1)),F(e)}},style:[S.button,{width:ee}],children:(0,m.jsx)(u.default,{name:"keyboard-arrow-left",size:X(30),color:"#fff"})}),(0,m.jsx)(i.default,{onPress:()=>{const e=o?.moves.length?o?.moves.length-1:-1;if(-1!==e&&z!==e){k({bestmove:"Press button to analyse",evaluation:""});const t=JSON.parse(o?.moves[z+1].fen);T(Math.min(z+1,e)),F(t)}},style:[S.button,{width:ee}],children:(0,m.jsx)(u.default,{name:"keyboard-arrow-right",size:X(30),color:"#fff"})}),(0,m.jsx)(i.default,{onPress:()=>{const e=o?.moves.length?o?.moves.length-1:-1;if(-1===e)return;z!==e&&k({bestmove:"Press button to analyse",evaluation:""});const t=JSON.parse(o?.moves[e].fen);T(e),F(t)},style:[S.button,{width:ee}],children:(0,m.jsx)(u.default,{name:"keyboard-double-arrow-right",size:X(30),color:"#fff"})})]})]})})}},3296:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(2772),l=a(558),o=a(3929),n=a(6283),r=a(3668),i=a(484),d=a(9637),c=a(397);const u=r.default.create({container:{flex:1,overflow:"hidden",justifyContent:"center",alignItems:"center",padding:20,backgroundColor:"#444"},image:{width:250,height:250,marginBottom:25},title:{fontSize:28,fontWeight:"bold",marginBottom:15,color:"#ccc",textAlign:"center"},subtitle:{fontSize:16,color:"#ccc",textAlign:"center",marginBottom:30,paddingHorizontal:20},button:{backgroundColor:"#00f",paddingVertical:12,paddingHorizontal:30,borderRadius:25,marginBottom:15,textAlign:"center",width:"100%"},buttonText:{color:"#fff",fontSize:16}}),f=()=>(0,c.jsx)(s.default,{children:(0,c.jsxs)(o.default,{style:[u.container,{minHeight:(0,l.default)().height}],children:[(0,c.jsx)(i.default,{source:{uri:"https://chessmate-production.up.railway.app/uploads/cm.png"},style:u.image,resizeMode:"contain"}),(0,c.jsx)(n.default,{style:u.title,children:"Oops! Page Not Found"}),(0,c.jsx)(n.default,{style:u.subtitle,children:"The page you're looking for doesn't exist or has been moved."}),(0,c.jsx)(d.Link,{href:"login",style:u.button,children:(0,c.jsx)(n.default,{style:u.buttonText,children:"Go to Home"})})]})})},5111:(e,t,a)=>{"use strict";a.r(t),a.d(t,{basePath:()=>r,default:()=>n,unstable_settings:()=>o});var s=a(9637),l=a(397);const o={initialRouteName:"index"};function n(){return(0,l.jsx)(s.Stack,{screenOptions:{headerShown:!1}})}const r="/chessmate_web"},5250:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>o});var s=a(1739),l=a(397);function o(){return(0,l.jsx)(s.default,{})}},5445:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(2772),l=a(558),o=a(3668),n=a(6283),r=a(3929),i=a(6773),d=a(5648),c=a(484),u=a(1087),f=a(9637),h=a(6665),g=a(397);const m=o.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",overflow:"hidden",backgroundColor:"#444"},title:{fontSize:32,fontWeight:"bold",marginBottom:40,color:"#fff"},profileImage:{width:200,height:200,borderRadius:50,marginBottom:10},input:{width:"80%",height:50,backgroundColor:"#444",color:"#ccc",borderColor:"#ccc",borderWidth:2,borderRadius:2,paddingHorizontal:15,marginBottom:5,fontSize:16},success:{width:"80%",color:"#000",marginBottom:10,fontSize:16,fontWeight:"bold"},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},button:{width:"80%",height:50,backgroundColor:"#fff",justifyContent:"center",alignItems:"center",borderRadius:5,marginBottom:5},buttonText:{color:"#00f",fontSize:18,fontWeight:"bold"},linkText:{color:"#00f",fontSize:14,fontWeight:"bold",marginVertical:10}}),p=()=>{const[e,t]=(0,h.useState)(!0),[a,o]=(0,h.useState)(""),[p,b]=(0,h.useState)(""),[x,y]=(0,h.useState)(""),[w,j]=(0,h.useState)(""),[S,k]=(0,h.useState)({username:!1,email:!1,password:!1,confirmPassword:!1}),[C,v]=(0,h.useState)("-1"),[z,T]=(0,h.useState)(!1),P=(0,f.useRouter)(),I="chessmate-production.up.railway.app";(0,h.useEffect)((()=>{e&&(async()=>{let e;try{const a=await u.default.getItem("token");e=await fetch("https://"+I+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"0"===e.code&&P.push("dashboard")}))})()}),[]);return(0,g.jsx)(s.default,{children:(0,g.jsxs)(r.default,{style:[m.container,{minHeight:(0,l.default)().height}],children:[(0,g.jsx)(n.default,{style:m.title,children:"ChessMate"}),(0,g.jsx)(c.default,{source:{uri:"https://"+I+"/uploads/cm.png"},style:m.profileImage}),(0,g.jsx)(i.default,{style:m.input,placeholder:"USERNAME",placeholderTextColor:"#bbb",value:a,onChangeText:o}),S.username&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid username. Username must start with a letter and contain only letters, numbers, or underscores. Length must be between 3 and 15 characters."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"EMAIL",placeholderTextColor:"#bbb",value:p,onChangeText:b,keyboardType:"email-address"}),S.email&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid email address."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"PASSWORD",placeholderTextColor:"#bbb",value:x,onChangeText:y,secureTextEntry:!0}),S.password&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid password. Password must contain only letters, numbers, or underscores. Length must be between 8 and 32 characters."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"CONFIRM PASSWORD",placeholderTextColor:"#bbb",value:w,onChangeText:j,secureTextEntry:!0}),S.confirmPassword&&(0,g.jsx)(n.default,{style:m.warning,children:"Passwords do not match."}),(0,g.jsx)(d.default,{style:m.button,onPress:async()=>{const e={username:!1,email:!1,password:!1,confirmPassword:!1};let t=!1;/^[A-Za-z][A-Za-z0-9_]{2,14}$/.test(a)||(e.username=!0,v("-1"),t=!0);/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(p)||(e.email=!0,v("-1"),t=!0);if(/^[A-Za-z0-9_]{8,32}$/.test(x)?w!==x&&(e.confirmPassword=!0,v("-1"),t=!0):(e.password=!0,v("-1"),t=!0),k(e),!t){T(!0);try{const e=await fetch("https://"+I+"/register",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:a,email:p,password:x})});if(e.ok){const t=await e.json();v(t.message)}else{const t=await e.json();v(t.error)}}catch(s){v("4")}finally{T(!1)}}},disabled:z,children:(0,g.jsx)(n.default,{style:m.buttonText,children:z?"Registering...":"REGISTER"})}),"0"===C&&(0,g.jsx)(n.default,{style:m.success,children:"Registration successful! We've sent you a confirmation email to prove your identity."}),"-1"!==C&&"0"!==C&&(0,g.jsx)(n.default,{style:m.warning,children:"1"===C?"Invalid credentials.":"2"===C?"Username already taken.":"3"===C?"Email already taken.":"Unknown error."}),(0,g.jsx)(f.Link,{href:"login",style:m.linkText,children:(0,g.jsx)(n.default,{style:m.linkText,children:"Already have an account? Login."})})]})})}},7353:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(2772),l=a(558),o=a(3668),n=a(6283),r=a(3929),i=a(6773),d=a(5648),c=a(484),u=a(1087),f=a(9637),h=a(6665),g=a(397);const m=o.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",overflow:"hidden",backgroundColor:"#444"},title:{fontSize:32,fontWeight:"bold",marginBottom:40,color:"#fff"},profileImage:{width:200,height:200,borderRadius:50,marginBottom:10},input:{width:"80%",height:50,backgroundColor:"#444",color:"#ccc",borderColor:"#ccc",borderWidth:2,borderRadius:2,paddingHorizontal:15,marginBottom:5,fontSize:16},success:{width:"80%",color:"#000",marginBottom:10,fontSize:16,fontWeight:"bold"},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},button:{width:"80%",height:50,backgroundColor:"#fff",justifyContent:"center",alignItems:"center",borderRadius:5,marginBottom:5},buttonText:{color:"#00f",fontSize:18,fontWeight:"bold"},linkText:{color:"#00f",fontSize:14,fontWeight:"bold",marginVertical:10}}),p=()=>{const{email:e}=(0,f.useLocalSearchParams)(),[t,a]=(0,h.useState)(!0),[o,p]=(0,h.useState)(""),[b,x]=(0,h.useState)(""),[y,w]=(0,h.useState)(""),[j,S]=(0,h.useState)({code:!1,password:!1,confirmPassword:!1}),[k,C]=(0,h.useState)("-1"),[v,z]=(0,h.useState)(!1),T=(0,f.useRouter)(),P="chessmate-production.up.railway.app";(0,h.useEffect)((()=>{t&&(async()=>{let e;try{const t=await u.default.getItem("token");e=await fetch("https://"+P+"/verify?token="+t),a(!1)}catch(t){return void a(!1)}e.json().then((e=>{"0"===e.code&&T.push("dashboard")}))})()}),[]);return(0,g.jsx)(s.default,{children:(0,g.jsxs)(r.default,{style:[m.container,{minHeight:(0,l.default)().height}],children:[(0,g.jsx)(n.default,{style:m.title,children:"ChessMate"}),(0,g.jsx)(c.default,{source:{uri:"https://"+P+"/uploads/cm.png"},style:m.profileImage}),(0,g.jsx)(n.default,{style:m.success,children:"Please enter the code we've sent on given email address."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"RESET CODE",placeholderTextColor:"#bbb",value:o,onChangeText:p,keyboardType:"numeric"}),j.code&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid code."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"NEW PASSWORD",placeholderTextColor:"#bbb",value:b,onChangeText:x,secureTextEntry:!0}),j.password&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid password. Password must contain only letters, numbers, or underscores. Length must be between 8 and 32 characters."}),(0,g.jsx)(i.default,{style:m.input,placeholder:"CONFIRM PASSWORD",placeholderTextColor:"#bbb",value:y,onChangeText:w,secureTextEntry:!0}),j.confirmPassword&&(0,g.jsx)(n.default,{style:m.warning,children:"Passwords do not match."}),(0,g.jsx)(d.default,{style:m.button,onPress:async()=>{const t={code:!1,password:!1,confirmPassword:!1};let a=!1;/^\d{6}$/.test(o)||(t.code=!0,C("-1"),a=!0);if(/^[A-Za-z0-9_]{8,32}$/.test(b)?y!==b&&(t.confirmPassword=!0,C("-1"),a=!0):(t.password=!0,C("-1"),a=!0),S(t),!a){z(!0);try{const t=await fetch("https://"+P+"/reset",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,resetCode:o,newPassword:b})});if(t.ok){const e=await t.json();C(e.message)}else{const e=await t.json();C(e.error)}}catch(s){C("4")}finally{z(!1)}}},disabled:v,children:(0,g.jsx)(n.default,{style:m.buttonText,children:v?"Resetting...":"RESET PASSWORD"})}),"0"===k&&(0,g.jsx)(n.default,{style:m.success,children:"Password reset successfully."}),"-1"!==k&&"0"!==k&&(0,g.jsx)(n.default,{style:m.warning,children:"1"===k?"Invalid code.":"2"===k?"Invalid email.":"3"===k?"Invalid or expired code.":"Unknown error."}),(0,g.jsx)(f.Link,{href:"login",style:m.linkText,children:(0,g.jsx)(n.default,{style:m.linkText,children:"Back to Login"})})]})})}},7901:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(3929),l=a(6283),o=a(3668),n=a(484),r=a(5648),i=a(2772),d=a(6773),c=a(1087),u=a(262),f=a(1385),h=a(9637),g=a(6665),m=a(397);const p=o.default.create({container:{padding:16,backgroundColor:"#444"},header:{flexDirection:"row",justifyContent:"space-between",marginBottom:20},headerText:{fontSize:24,color:"#fff",fontWeight:"bold"},profileSection:{alignItems:"center",marginBottom:20},profileImage:{width:100,height:100,borderRadius:50,marginBottom:10},cameraIcon:{position:"absolute",bottom:10,right:10,backgroundColor:"#0008",borderRadius:12,padding:4},userName:{fontSize:20,color:"#fff",fontWeight:"bold"},inputContainer:{marginBottom:20},label:{fontSize:16,fontWeight:"bold",color:"#fff",textAlign:"center",marginBottom:8},input:{backgroundColor:"#888",borderRadius:8,padding:16,color:"#fff",fontSize:16},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},saveButton:{backgroundColor:"#00f",borderRadius:8,padding:16,alignItems:"center"},saveButtonText:{color:"#fff",fontSize:16,fontWeight:"bold"}}),b=()=>{const[e,t]=(0,g.useState)(!0),[a,o]=(0,g.useState)(""),[b,x]=(0,g.useState)(""),[y,w]=(0,g.useState)(""),[j,S]=(0,g.useState)(""),[k,C]=(0,g.useState)(""),[v,z]=(0,g.useState)("0"),[T,P]=(0,g.useState)(!1),I=(0,h.useRouter)(),R="chessmate-production.up.railway.app";(0,g.useEffect)((()=>{e&&(async()=>{let e;try{const a=await c.default.getItem("token");e=await fetch("https://"+R+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"1"===e.code&&I.push("login")}))})()}),[]);(0,g.useEffect)((()=>{b||(async()=>{let e=await c.default.getItem("token");o(e||"");const t=await fetch("https://"+R+"/data?token="+e),a=await t.json(),s=await a.message.username,l=await a.message.profile_picture_url;x(s);const n=await fetch("https://"+R+"/"+l);w(n.url);const r=await a.message.description;S(r)})()}),[]);return(0,m.jsxs)(i.default,{style:p.container,children:[(0,m.jsxs)(s.default,{style:p.header,children:[(0,m.jsx)(h.Link,{href:"profile",children:(0,m.jsx)(s.default,{children:(0,m.jsx)(f.default,{name:"arrow-back",size:24,color:"#ccc"})})}),(0,m.jsx)(l.default,{style:p.headerText,children:"Settings"}),(0,m.jsx)(h.Link,{href:"dashboard",children:(0,m.jsx)(s.default,{children:(0,m.jsx)(f.default,{name:"menu",size:24,color:"#ccc"})})})]}),(0,m.jsxs)(s.default,{style:p.profileSection,children:[(0,m.jsxs)(r.default,{onPress:async()=>{try{const e=await u.launchImageLibraryAsync({mediaTypes:"images",allowsEditing:!0,quality:.8,base64:!0});e.assets&&C(e.assets[0])}catch(e){alert("Invalid image!")}},children:[(0,m.jsx)(n.default,{source:k||{uri:y},style:p.profileImage}),(0,m.jsx)(f.default,{name:"camera",size:24,color:"#ccc",style:p.cameraIcon})]}),(0,m.jsx)(l.default,{style:p.userName,children:b})]}),(0,m.jsxs)(s.default,{style:p.inputContainer,children:[(0,m.jsx)(l.default,{style:p.label,children:"Description"}),(0,m.jsx)(d.default,{style:p.input,multiline:!0,numberOfLines:4,value:j,onChangeText:S})]}),"0"!==v&&(0,m.jsx)(l.default,{style:p.warning,children:"1"===v?"Invalid image.":"2"===v?"Unable to save image.":"Unknown error."}),(0,m.jsx)(r.default,{onPress:async()=>{P(!0);try{k.base64||z("1");let e="jpg";k.uri&&(e=k.uri.split("/")[1].split(";")[0].toLowerCase());["jpg","jpeg","png"].includes(e)||z("1");const t=await fetch("https://"+R+"/update",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({token:a,image:k.base64,filename:`image_${Date.now()}.${e}`,description:j})}),s=await t.json();t.ok?z(s.message):z(s.error)}catch(e){z("3")}finally{P(!1)}},style:p.saveButton,disabled:T,children:(0,m.jsx)(l.default,{style:p.saveButtonText,children:T?"Saving...":"SAVE"})})]})}},8415:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>b});var s=a(3929),l=a(6283),o=a(3668),n=a(484),r=a(5648),i=a(2772),d=a(932),c=a(1087),u=a(1410),f=a(1385),h=a(9637),g=a(6665),m=a(397);const p=o.default.create({container:{flex:1,padding:16,backgroundColor:"#444"},header:{flexDirection:"row",justifyContent:"space-between",alignItems:"center",marginBottom:20},headerText:{fontSize:24,color:"#fff",fontWeight:"bold"},profileSection:{alignItems:"center",marginBottom:20},profileImage:{width:100,height:100,borderRadius:50,marginBottom:10},userName:{fontSize:20,color:"#fff",fontWeight:"bold"},userDescription:{fontSize:16,color:"#fff",textAlign:"center",marginBottom:20},buttonContainer:{flexDirection:"row",justifyContent:"space-between",backgroundColor:"#888",borderRadius:5,marginBottom:20},button:{backgroundColor:"#ccc",paddingVertical:10,paddingHorizontal:20,marginHorizontal:20,borderRadius:5},buttonText:{fontSize:16,fontWeight:"bold"},statContainer:{backgroundColor:"#888",borderRadius:8,padding:16},statRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},statLabel:{fontSize:16},statValue:{fontSize:16,fontWeight:"bold"},dropdownContainer:{backgroundColor:"#fff",borderRadius:8,padding:16,marginBottom:16,alignItems:"center"},gameItem:{flexDirection:"row",padding:10,marginVertical:5,backgroundColor:"#ccc",borderRadius:5,justifyContent:"space-between"},gameText:{backgroundColor:"#888",fontWeight:"bold",color:"#fff",borderRadius:5,padding:10,margin:5},emptyText:{color:"#ccc",textAlign:"center",marginVertical:20}}),b=()=>{const[e,t]=(0,g.useState)(!0),[a,o]=(0,g.useState)(""),[b,x]=(0,g.useState)(""),[y,w]=(0,g.useState)(""),[j,S]=(0,g.useState)(""),[k,C]=(0,g.useState)({bullet:0,blitz:0,rapid:0,classical:0,all:0}),[v,z]=(0,g.useState)({bulletWins:0,bulletLosses:0,bulletDraws:0,bulletGames:0,blitzWins:0,blitzLosses:0,blitzDraws:0,blitzGames:0,rapidWins:0,rapidLosses:0,rapidDraws:0,rapidGames:0,classicalWins:0,classicalLosses:0,classicalDraws:0,classicalGames:0,allWins:0,allLosses:0,allDraws:0,allGames:0}),[T,P]=(0,g.useState)([]),[I,R]=(0,g.useState)(!0),[B,W]=(0,g.useState)(null),L=(0,h.useRouter)(),N="chessmate-production.up.railway.app";(0,g.useEffect)((()=>{e&&(async()=>{let e;try{const a=await c.default.getItem("token");e=await fetch("https://"+N+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"1"===e.code&&L.push("login")}))})()}),[]);(0,g.useEffect)((()=>{b||(async()=>{let e=await c.default.getItem("token");o(e||"");const t=await fetch("https://"+N+"/data?token="+e),a=await t.json(),s=await a.message.username,l=await a.message.profile_picture_url;x(s);const n=await fetch("https://"+N+"/"+l);w(n.url);const r=await a.message.description;S(r);const i=await a.message.bullet_rating,d=await a.message.blitz_rating,u=await a.message.rapid_rating,f=await a.message.classical_rating;C({bullet:i,blitz:d,rapid:u,classical:f,all:Math.round((i+d+u+f)/4)});const h=await a.message.bullet_wins,g=await a.message.bullet_losses,m=await a.message.bullet_draws,p=await a.message.blitz_wins,b=await a.message.blitz_losses,y=await a.message.blitz_draws,j=await a.message.rapid_wins,k=await a.message.rapid_losses,v=await a.message.rapid_draws,T=await a.message.classical_wins,P=await a.message.classical_losses,I=await a.message.classical_draws;z({bulletWins:h,bulletLosses:g,bulletDraws:m,bulletGames:h+g+m,blitzWins:p,blitzLosses:b,blitzDraws:y,blitzGames:p+b+y,rapidWins:j,rapidLosses:k,rapidDraws:v,rapidGames:j+k+v,classicalWins:T,classicalLosses:P,classicalDraws:I,classicalGames:T+P+I,allWins:h+p+j+T,allLosses:g+b+k+P,allDraws:m+y+v+I,allGames:h+p+j+T+g+b+k+P+m+y+v+I})})()}),[]);return(0,m.jsxs)(i.default,{style:p.container,children:[(0,m.jsxs)(s.default,{style:p.header,children:[(0,m.jsx)(h.Link,{href:"dashboard",children:(0,m.jsx)(s.default,{children:(0,m.jsx)(f.default,{name:"arrow-back",size:24,color:"#ccc"})})}),(0,m.jsx)(l.default,{style:p.headerText,children:"Profile"}),(0,m.jsx)(h.Link,{href:"settings",children:(0,m.jsx)(s.default,{children:(0,m.jsx)(f.default,{name:"settings",size:24,color:"#ccc"})})})]}),(0,m.jsxs)(s.default,{style:p.profileSection,children:[(0,m.jsx)(n.default,{source:{uri:y},style:p.profileImage}),(0,m.jsx)(l.default,{style:p.userName,children:b})]}),(0,m.jsx)(l.default,{style:p.userDescription,children:j}),(0,m.jsxs)(s.default,{style:p.buttonContainer,children:[(0,m.jsx)(r.default,{style:p.button,onPress:()=>{R(!0)},children:(0,m.jsx)(l.default,{style:p.buttonText,children:"Stats"})}),(0,m.jsx)(r.default,{style:p.button,onPress:()=>{(async()=>{(await fetch("https://"+N+"/archives?token="+a)).json().then((e=>{e.sort(((e,t)=>t.completed_at.localeCompare(e.completed_at))),P(e)}))})(),R(!1)},children:(0,m.jsx)(l.default,{style:p.buttonText,children:"Games"})})]}),I?(0,m.jsxs)(s.default,{style:p.statContainer,children:[(0,m.jsx)(s.default,{style:p.dropdownContainer,children:(0,m.jsx)(u.default,{onValueChange:e=>W(e),items:[{label:"Bullet",value:"bullet"},{label:"Blitz",value:"blitz"},{label:"Rapid",value:"rapid"},{label:"Classical",value:"classical"}],placeholder:{label:"All",value:"all"}})}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Rating"}),(0,m.jsx)(l.default,{style:p.statValue,children:"bullet"===B?k.bullet:"blitz"===B?k.blitz:"rapid"===B?k.rapid:"classical"===B?k.classical:k.all})]}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Games Played"}),(0,m.jsx)(l.default,{style:p.statValue,children:"bullet"===B?v.bulletGames:"blitz"===B?v.blitzGames:"rapid"===B?v.rapidGames:"classical"===B?v.classicalGames:v.allGames})]}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Wins"}),(0,m.jsx)(l.default,{style:p.statValue,children:"bullet"===B?v.bulletWins:"blitz"===B?v.blitzWins:"rapid"===B?v.rapidWins:"classical"===B?v.classicalWins:v.allWins})]}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Losses"}),(0,m.jsx)(l.default,{style:p.statValue,children:"bullet"===B?v.bulletLosses:"blitz"===B?v.blitzLosses:"rapid"===B?v.rapidLosses:"classical"===B?v.classicalLosses:v.allLosses})]}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Draws"}),(0,m.jsx)(l.default,{style:p.statValue,children:"bullet"===B?v.bulletDraws:"blitz"===B?v.blitzDraws:"rapid"===B?v.rapidDraws:"classical"===B?v.classicalDraws:v.allDraws})]}),(0,m.jsxs)(s.default,{style:p.statRow,children:[(0,m.jsx)(l.default,{style:p.statLabel,children:"Win Rate"}),(0,m.jsxs)(l.default,{style:p.statValue,children:["bullet"===B?0===Number(v.bulletGames)?0:(100*Number(v.bulletWins)/Number(v.bulletGames)).toFixed(2):"blitz"===B?0===Number(v.blitzGames)?0:(100*Number(v.blitzWins)/Number(v.blitzGames)).toFixed(2):"rapid"===B?0===Number(v.rapidGames)?0:(100*Number(v.rapidWins)/Number(v.rapidGames)).toFixed(2):"classical"===B?0===Number(v.classicalGames)?0:(100*Number(v.classicalWins)/Number(v.classicalGames)).toFixed(2):0===Number(v.allGames)?0:(100*Number(v.allWins)/Number(v.allGames)).toFixed(2),"%"]})]})]}):(0,m.jsx)(d.default,{data:T,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,m.jsx)(i.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:(0,m.jsxs)(r.default,{style:p.gameItem,onPress:()=>{var t;t=e.id,L.push(`archive?archive=${t}`)},children:[(0,m.jsx)(l.default,{style:p.gameText,children:e.user}),(0,m.jsx)(l.default,{style:p.gameText,children:e.rating}),(0,m.jsx)(l.default,{style:p.gameText,children:e.color}),(0,m.jsx)(l.default,{style:p.gameText,children:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"===e.starting_position?"Standard":"Custom"}),(0,m.jsx)(l.default,{style:p.gameText,children:e.time_control}),(0,m.jsx)(l.default,{style:p.gameText,children:"white"===e.result?"White\xa0won":"black"===e.result?"Black\xa0won":"Draw"}),(0,m.jsx)(l.default,{style:p.gameText,children:e.completed_at.substring(0,10).replace("-","\u2011").replace("-","\u2011")})]})}),ListEmptyComponent:(0,m.jsx)(l.default,{style:p.emptyText,children:"No games in the archive"})})]})}},8973:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(2772),l=a(558),o=a(3929),n=a(6283),r=a(3668),i=a(484),d=a(9637),c=a(397);const u=r.default.create({container:{flex:1,overflow:"hidden",justifyContent:"center",alignItems:"center",padding:20,backgroundColor:"#444"},image:{width:250,height:250,marginBottom:25},title:{fontSize:28,fontWeight:"bold",marginBottom:15,color:"#ccc",textAlign:"center"},subtitle:{fontSize:16,color:"#ccc",textAlign:"center",marginBottom:30,paddingHorizontal:20},button:{backgroundColor:"#00f",paddingVertical:12,paddingHorizontal:30,borderRadius:25,marginBottom:15,textAlign:"center",width:"100%"},buttonText:{color:"#fff",fontSize:16}}),f=()=>(0,c.jsx)(s.default,{children:(0,c.jsxs)(o.default,{style:[u.container,{minHeight:(0,l.default)().height}],children:[(0,c.jsx)(i.default,{source:{uri:"https://chessmate-production.up.railway.app/uploads/cm.png"},style:u.image,resizeMode:"contain"}),(0,c.jsx)(n.default,{style:u.title,children:"Oops! Page Not Found"}),(0,c.jsx)(n.default,{style:u.subtitle,children:"The page you're looking for doesn't exist or has been moved."}),(0,c.jsx)(d.Link,{href:"login",style:u.button,children:(0,c.jsx)(n.default,{style:u.buttonText,children:"Go to Home"})})]})})},9099:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>p});var s=a(2772),l=a(558),o=a(3668),n=a(6283),r=a(3929),i=a(6773),d=a(5648),c=a(484),u=a(1087),f=a(9637),h=a(6665),g=a(397);const m=o.default.create({container:{flex:1,justifyContent:"center",alignItems:"center",overflow:"hidden",backgroundColor:"#444"},title:{fontSize:32,fontWeight:"bold",marginBottom:40,color:"#fff"},profileImage:{width:200,height:200,borderRadius:50,marginBottom:10},input:{width:"80%",height:50,backgroundColor:"#444",color:"#ccc",borderColor:"#ccc",borderWidth:2,borderRadius:2,paddingHorizontal:15,marginBottom:5,fontSize:16},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},button:{width:"80%",height:50,backgroundColor:"#fff",justifyContent:"center",alignItems:"center",borderRadius:5,marginBottom:5},buttonText:{color:"#00f",fontSize:18,fontWeight:"bold"},linkText:{color:"#00f",fontSize:14,fontWeight:"bold",marginVertical:10}}),p=()=>{const[e,t]=(0,h.useState)(!0),[a,o]=(0,h.useState)(""),[p,b]=(0,h.useState)(!1),[x,y]=(0,h.useState)("0"),[w,j]=(0,h.useState)(!1),S=(0,f.useRouter)(),k="chessmate-production.up.railway.app";(0,h.useEffect)((()=>{e&&(async()=>{let e;try{const a=await u.default.getItem("token");e=await fetch("https://"+k+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"0"===e.code&&S.push("dashboard")}))})()}),[]);return(0,g.jsx)(s.default,{children:(0,g.jsxs)(r.default,{style:[m.container,{minHeight:(0,l.default)().height}],children:[(0,g.jsx)(n.default,{style:m.title,children:"ChessMate"}),(0,g.jsx)(c.default,{source:{uri:"https://"+k+"/uploads/cm.png"},style:m.profileImage}),(0,g.jsx)(i.default,{style:m.input,placeholder:"EMAIL",placeholderTextColor:"#bbb",value:a,onChangeText:o,keyboardType:"email-address"}),p&&(0,g.jsx)(n.default,{style:m.warning,children:"Invalid email address."}),(0,g.jsx)(d.default,{style:m.button,onPress:async()=>{if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(a))return b(!0),void y("0");b(!1),j(!0);try{const e=await fetch("https://"+k+"/forgot",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:a})});if(e.ok)S.push({pathname:"reset",params:{email:a}});else{const t=await e.json();y(t.error)}}catch(e){y("2")}finally{j(!1)}},disabled:w,children:(0,g.jsx)(n.default,{style:m.buttonText,children:w?"Sending...":"RESET PASSWORD"})}),"0"!==x&&(0,g.jsx)(n.default,{style:m.warning,children:"1"===x?"We don't have a record of this email on our database.":"Unknown error."}),(0,g.jsx)(f.Link,{href:"login",style:m.linkText,children:(0,g.jsx)(n.default,{style:m.linkText,children:"Back to Login"})})]})})}},9140:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>w});var s=a(3929),l=a(6283),o=a(6773),n=a(5648),r=a(3668),i=a(2772),d=a(558),c=a(484),u=a(8264),f=a(932),h=a(1087),g=a(7851),m=a.n(g),p=a(9637),b=a(6665),x=a(397);const y=r.default.create({container:{flex:1,padding:16,backgroundColor:"#444"},header:{overflow:"hidden",flexDirection:"row",justifyContent:"space-between",marginTop:32,marginBottom:16,borderRadius:4,backgroundColor:"#888"},title:{fontSize:24,fontWeight:"bold",color:"#fff"},profileSection:{flexShrink:1,overflow:"hidden",flexDirection:"row",padding:8,borderRadius:4,backgroundColor:"#000"},profile:{width:20,height:20,borderRadius:20,marginRight:5},menuText:{color:"#fff",fontSize:16},sectionTitle:{fontSize:18,textAlign:"center",fontWeight:"bold",color:"#fff",marginBottom:16},modeRow:{flexDirection:"row",justifyContent:"space-between",marginBottom:8},link:{flex:1},modeButton:{padding:16,backgroundColor:"#888",borderRadius:4,marginHorizontal:4,justifyContent:"center",alignItems:"center"},modeText:{fontSize:16,color:"#fff"},modeLabel:{fontSize:14,color:"#fff"},modalContainer:{flex:1,justifyContent:"center",alignItems:"center",backgroundColor:"#0008"},modalContent:{width:"80%",backgroundColor:"#444",borderRadius:10,padding:20},modalTitle:{fontSize:20,fontWeight:"bold",color:"#fff",marginBottom:20,textAlign:"center"},position:{width:"100%",backgroundColor:"#888",borderRadius:8,padding:16,color:"#fff",fontSize:16},warning:{width:"80%",color:"#f00",marginBottom:10,fontSize:16,fontWeight:"bold"},fenLabel:{fontSize:16,fontWeight:"bold",color:"#fff",textAlign:"center",marginTop:15,marginBottom:10},sectionHeader:{fontSize:16,color:"#fff",marginTop:15,marginBottom:10},optionRow:{flexDirection:"row",marginBottom:10},optionButton:{flex:1,padding:10,marginHorizontal:5,borderRadius:5,backgroundColor:"#888",alignItems:"center"},selectedOption:{backgroundColor:"#00f"},optionText:{color:"#fff"},gameItem:{flexDirection:"row",padding:10,marginVertical:5,backgroundColor:"#ccc",borderRadius:5,justifyContent:"space-between"},gameText:{backgroundColor:"#888",fontWeight:"bold",color:"#fff",borderRadius:5,padding:10,margin:5},emptyText:{color:"#ccc",textAlign:"center",marginVertical:20},modalButtons:{flexDirection:"row",marginTop:20},createButton:{flex:1,padding:10,backgroundColor:"#00f",borderRadius:5,marginRight:10,alignItems:"center"},cancelButton:{flex:1,padding:10,backgroundColor:"#888",borderRadius:5,alignItems:"center"},buttonText:{color:"#fff"},difficultyText:{textAlign:"center",color:"#fff",marginTop:8,fontSize:16}}),w=()=>{const[e,t]=(0,b.useState)(!0),[a,r]=(0,b.useState)(""),[g,w]=(0,b.useState)(""),[j,S]=(0,b.useState)({bullet:0,blitz:0,rapid:0,classical:0}),[k,C]=(0,b.useState)(!1),[v,z]=(0,b.useState)(""),[T,P]=(0,b.useState)(""),[I,R]=(0,b.useState)([]),[B,W]=(0,b.useState)("player"),[L,N]=(0,b.useState)("rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR"),[_,O]=(0,b.useState)(!1),[D,A]=(0,b.useState)("random"),[E,$]=(0,b.useState)(5),[G,H]=(0,b.useState)("standard"),M=(0,p.useRouter)(),V="chessmate-production.up.railway.app";let q;(0,b.useEffect)((()=>{e&&(async()=>{let e;try{const a=await h.default.getItem("token");e=await fetch("https://"+V+"/verify?token="+a),t(!1)}catch(a){return void t(!1)}e.json().then((e=>{"1"===e.code&&(C(!1),M.push("login"))}))})()}),[]);const K=async()=>{try{const e=await fetch("https://"+V+"/create",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({position:"standard"===G?"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR":L,type:B,timeControl:v,gameMode:T,difficulty:E})});if(!e.ok)return void O(!0);const t=await e.json();C(!1),M.push(`game?gameId=${t}&color=${D}&name=${a}&image=${g}&rating=${"bullet"===T?j.bullet:"blitz"===T?j.blitz:"rapid"===T?j.rapid:j.classical}`)}catch(e){console.error("Error creating new game: "+e)}};(0,b.useEffect)((()=>{a||(async()=>{q=await h.default.getItem("token");const e=await fetch("https://"+V+"/data?token="+q),t=await e.json(),a=await t.message.username,s=await t.message.profile_picture_url;r(a);const l=await fetch("https://"+V+"/"+s);w(l.url);const o=await t.message.bullet_rating,n=await t.message.blitz_rating,i=await t.message.rapid_rating,d=await t.message.classical_rating;S({bullet:o,blitz:n,rapid:i,classical:d})})()}),[]),(0,b.useEffect)((()=>{k&&(async()=>{try{const e=await fetch("https://"+V+"/games?mode="+T),t=await e.json();R(t)}catch(e){console.error("Error fetching active games: "+e)}})()}),[k]);const Q=({time:e,label:t})=>(0,x.jsxs)(n.default,{style:y.modeButton,onPress:()=>((e,t)=>{z(e),P(t),C(!0)})(e,t),children:[(0,x.jsx)(l.default,{style:y.modeText,children:e}),(0,x.jsx)(l.default,{style:y.modeLabel,children:t})]});return(0,x.jsx)(i.default,{children:(0,x.jsxs)(s.default,{style:[y.container,{minHeight:(0,d.default)().height}],children:[(0,x.jsxs)(s.default,{style:y.header,children:[(0,x.jsx)(n.default,{onPress:()=>(async()=>{await h.default.setItem("token",""),C(!1),M.push("login")})(),children:(0,x.jsx)(s.default,{style:y.profileSection,children:(0,x.jsx)(l.default,{style:y.menuText,children:"Logout"})})}),(0,x.jsx)(l.default,{style:y.title,children:"ChessMate"}),(0,x.jsx)(p.Link,{href:"profile",children:(0,x.jsxs)(s.default,{style:y.profileSection,children:[(0,x.jsx)(c.default,{source:{uri:g},style:y.profile}),(0,x.jsx)(l.default,{style:y.menuText,children:a})]})})]}),(0,x.jsxs)(l.default,{style:y.fenLabel,children:["Starting Position ","(","fen notation",")"]}),(0,x.jsxs)(s.default,{style:y.optionRow,children:[(0,x.jsx)(n.default,{style:[y.optionButton,"standard"===G&&y.selectedOption],onPress:()=>H("standard"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Standard"})}),(0,x.jsx)(n.default,{style:[y.optionButton,"custom"===G&&y.selectedOption],onPress:()=>H("custom"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Custom"})})]}),"custom"===G&&(0,x.jsx)(s.default,{style:y.optionRow,children:(0,x.jsx)(o.default,{style:y.position,value:L,onChangeText:N})}),(0,x.jsx)(l.default,{style:y.sectionTitle,children:"Select Chess Mode to Play"}),(0,x.jsxs)(s.default,{style:y.modeRow,children:[(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"1+0",label:"Bullet"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"2+1",label:"Bullet"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"3+0",label:"Bullet"})})]}),(0,x.jsxs)(s.default,{style:y.modeRow,children:[(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"3+2",label:"Blitz"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"5+0",label:"Blitz"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"5+3",label:"Blitz"})})]}),(0,x.jsxs)(s.default,{style:y.modeRow,children:[(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"10+0",label:"Rapid"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"10+5",label:"Rapid"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"15+0",label:"Rapid"})})]}),(0,x.jsxs)(s.default,{style:y.modeRow,children:[(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"15+10",label:"Classical"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"30+0",label:"Classical"})}),(0,x.jsx)(s.default,{style:y.link,children:(0,x.jsx)(Q,{time:"30+20",label:"Classical"})})]}),(0,x.jsx)((()=>{return(0,x.jsx)(u.default,{animationType:"fade",transparent:!0,visible:k,onRequestClose:()=>C(!1),children:(0,x.jsx)(i.default,{children:(0,x.jsx)(s.default,{style:[y.modalContainer,{minHeight:(0,d.default)().height}],children:(0,x.jsxs)(s.default,{style:y.modalContent,children:[(0,x.jsx)(l.default,{style:y.modalTitle,children:"Game Options"}),(0,x.jsx)(l.default,{style:y.sectionHeader,children:"Game Type"}),(0,x.jsxs)(s.default,{style:y.optionRow,children:[(0,x.jsx)(n.default,{style:[y.optionButton,"player"===B&&y.selectedOption],onPress:()=>W("player"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Play vs Player"})}),(0,x.jsx)(n.default,{style:[y.optionButton,"ai"===B&&y.selectedOption],onPress:()=>W("ai"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Play vs AI"})})]}),(0,x.jsx)(l.default,{style:y.sectionHeader,children:"Your Color"}),(0,x.jsxs)(s.default,{style:y.optionRow,children:[(0,x.jsx)(n.default,{style:[y.optionButton,"white"===D&&y.selectedOption],onPress:()=>A("white"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"White"})}),(0,x.jsx)(n.default,{style:[y.optionButton,"black"===D&&y.selectedOption],onPress:()=>A("black"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Black"})}),(0,x.jsx)(n.default,{style:[y.optionButton,"random"===D&&y.selectedOption],onPress:()=>A("random"),children:(0,x.jsx)(l.default,{style:y.optionText,children:"Random"})})]}),(0,x.jsx)(l.default,{style:y.sectionHeader,children:"player"===B?"Active Games":"AI Difficulty"}),"player"===B?(0,x.jsx)(f.default,{data:I,keyExtractor:e=>e.id,renderItem:({item:e})=>(0,x.jsx)(i.default,{horizontal:!0,showsHorizontalScrollIndicator:!1,children:(0,x.jsxs)(n.default,{style:y.gameItem,onPress:()=>{return t=e.id,C(!1),void M.push(`game?gameId=${t}&color=${D}&name=${a}&image=${g}&rating=${"bullet"===T?j.bullet:"blitz"===T?j.blitz:"rapid"===T?j.rapid:j.classical}`);var t},children:[(0,x.jsx)(l.default,{style:y.gameText,children:e.opponent}),(0,x.jsx)(l.default,{style:y.gameText,children:e.rating}),(0,x.jsx)(l.default,{style:y.gameText,children:e.position}),(0,x.jsx)(l.default,{style:y.gameText,children:e.time}),(0,x.jsx)(l.default,{style:y.gameText,children:e.color})]})}),ListEmptyComponent:(0,x.jsx)(l.default,{style:y.emptyText,children:"No games to join"})}):(0,x.jsxs)(s.default,{children:[(0,x.jsx)(m(),{minimumValue:0,maximumValue:20,step:1,value:E,onValueChange:$,minimumTrackTintColor:"#00f",maximumTrackTintColor:"#888"}),(0,x.jsxs)(l.default,{style:y.difficultyText,children:["Level: ",E," (",(e=E,e<=3?"Beginner":e<=6?"Intermediate":e<=9?"Advanced":e<=12?"Master":e<=15?"Grandmaster":"Impossible"),")"]})]}),"custom"===G&&_&&(0,x.jsx)(l.default,{style:y.warning,children:"Your fen string is invalid!"}),(0,x.jsxs)(s.default,{style:y.modalButtons,children:[(0,x.jsx)(n.default,{style:y.createButton,onPress:K,children:(0,x.jsx)(l.default,{style:y.buttonText,children:"Create a game"})}),(0,x.jsx)(n.default,{style:y.cancelButton,onPress:()=>{C(!1),O(!1)},children:(0,x.jsx)(l.default,{style:y.buttonText,children:"Cancel"})})]})]})})})});var e}),{})]})})}}},t={};function a(s){var l=t[s];if(void 0!==l)return l.exports;var o=t[s]={id:s,loaded:!1,exports:{}};return e[s].call(o.exports,o,o.exports,a),o.loaded=!0,o.exports}a.m=e,(()=>{var e=[];a.O=(t,s,l,o)=>{if(!s){var n=1/0;for(c=0;c<e.length;c++){for(var[s,l,o]=e[c],r=!0,i=0;i<s.length;i++)(!1&o||n>=o)&&Object.keys(a.O).every((e=>a.O[e](s[i])))?s.splice(i--,1):(r=!1,o<n&&(n=o));if(r){e.splice(c--,1);var d=l();void 0!==d&&(t=d)}}return t}o=o||0;for(var c=e.length;c>0&&e[c-1][2]>o;c--)e[c]=e[c-1];e[c]=[s,l,o]}})(),a.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return a.d(t,{a:t}),t},a.d=(e,t)=>{for(var s in t)a.o(t,s)&&!a.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},a.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}(),a.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),a.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},a.nmd=e=>(e.paths=[],e.children||(e.children=[]),e),a.p="/chessmate_web/",(()=>{var e={792:0};a.O.j=t=>0===e[t];var t=(t,s)=>{var l,o,[n,r,i]=s,d=0;if(n.some((t=>0!==e[t]))){for(l in r)a.o(r,l)&&(a.m[l]=r[l]);if(i)var c=i(a)}for(t&&t(s);d<n.length;d++)o=n[d],a.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return a.O(c)},s=self.webpackChunkweb=self.webpackChunkweb||[];s.forEach(t.bind(null,0)),s.push=t.bind(null,s.push.bind(s))})();var s=a.O(void 0,[308],(()=>a(1697)));s=a.O(s)})();
//# sourceMappingURL=main.a93edabe.js.map